# ============================================================
# NKFX Universal Health Monitor Configuration
# ============================================================
# Auto-discovery enabled - new containers are automatically detected!
# Manual entries below are for overrides (health endpoints, etc.)
# Last updated: 2026-01-08

telegram:
  bot_token: "8521469204:AAHOlxYLdy7sb2QvHjdgP1nxNxMyX_0yemY"
  chat_id: "886054648"

settings:
  check_interval: 300  # 5 minutes (for cron reference)
  auto_restart: true
  alert_on_restart: true
  alert_on_recovery: true
  daily_summary: true
  daily_summary_hour: 8  # 08:00 UTC
  log_file: "/root/nkfx/logs/health.log"
  state_file: "/root/nkfx/monitoring/state.json"
  
  # ============================================================
  # AUTO-DISCOVERY SETTINGS
  # ============================================================
  auto_discovery: true  # Enable container auto-discovery
  auto_patterns:        # Containers matching these patterns are auto-included
    - nkfx
    - mt5
    - vnc
    - kraken
    - pancake
    - n8n
    - qdrant
    - cloudflare
    - bridge
    - redis
    - webdis

# ============================================================
# MANUAL SERVICE OVERRIDES
# ============================================================
# These entries override auto-discovered settings.
# Use for: health endpoints, compose paths, critical flags
# If a container is auto-discovered AND listed here, 
# the manual config takes precedence.

services:
  # SMC Bot Ecosystem - with health endpoints
  - name: "mt5-bridge-smc"
    type: "docker"
    critical: true
    compose_path: "/root/trading-stack-smc"
    health_endpoint: "http://localhost:5001/health"
    description: "MT5 Bridge for SMC"

  # Wyckoff Bot Ecosystem
  - name: "mt5-bridge"
    type: "docker"
    critical: true
    compose_path: "/root/trading-stack"
    health_endpoint: "http://localhost:5000/health"
    description: "MT5 Bridge for Wyckoff"

  # Trading Factory with health endpoint
  - name: "nkfx-factory"
    type: "docker"
    critical: true
    compose_path: "/root/nkfx/infrastructure/nkfx-trading-factory"
    health_endpoint: "http://localhost:8000/health"
    description: "NKFX Trading Factory"

  # Signal Intelligence with health endpoints
  - name: "nkfx-features"
    type: "docker"
    critical: false
    compose_path: "/root/nkfx/infrastructure/nkfx-signal-intelligence"
    health_endpoint: "http://localhost:8100/health"
    description: "Signal Feature Extraction"

  - name: "nkfx-qdrant"
    type: "docker"
    critical: false
    compose_path: "/root/nkfx/infrastructure/nkfx-signal-intelligence"
    health_endpoint: "http://localhost:6333/readyz"
    description: "Qdrant Vector DB"

  # n8n - mark as critical
  - name: "root_n8n_1"
    type: "docker"
    critical: true
    compose_path: "/root"
    description: "n8n Automation"

  # Cloudflare tunnel - critical
  - name: "root_cloudflared_1"
    type: "docker"
    critical: true
    compose_path: "/root"
    description: "Cloudflare Tunnel"
